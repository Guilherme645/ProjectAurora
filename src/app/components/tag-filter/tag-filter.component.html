<div *ngIf="!isMobile" class="fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50 z-50">
    <div class="bg-white w-[645px] h-[535px] rounded-2xl shadow-lg flex flex-col overflow-hidden">
        
        <div class="sticky top-0 z-10 bg-white">
            <div class="flex items-center justify-between p-4 border-b border-gray-200">
                <div class="flex items-center gap-3 w-full">
                    <svg class="w-6 h-6 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.3-4.3"></path>
                    </svg>
                    <input 
                        type="text" 
                        class="w-full border-none outline-none text-gray-700 text-sm placeholder-gray-400" 
                        placeholder="Procurar entidades" 
                        [(ngModel)]="searchQuery"
                        (input)="filterEntities()"
                    />
                </div>
                <button class="w-[30px] h-[18px] text-gray-700 border rounded-md hover:bg-gray-100 text-xs flex items-center justify-center"
                    (click)="closeMobileModal()">
                    ESC
                </button>
            </div>
        </div>

        <div class="flex-1 flex h-full overflow-y-auto">
            <nav class="w-[169px] border-r border-gray-200 p-4 space-y-2">
                <button (click)="selectCategory('Data')"
                    [class.text-blue-600]="selectedCategory === 'Data'"
                    class="flex items-center gap-2 text-sm text-gray-700 hover:text-blue-600 focus:text-blue-600">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide"><path d="M8 2v4" key="1cmpym"></path><path d="M16 2v4" key="4m81vk"></path><rect width="18" height="18" x="3" y="4" rx="2" key="1hopcy"></rect><path d="M3 10h18" key="8toen8"></path><path d="M8 14h.01" key="6423bh"></path><path d="M12 14h.01" key="1etili"></path><path d="M16 14h.01" key="1gbofw"></path><path d="M8 18h.01" key="lrp35t"></path><path d="M12 18h.01" key="mhygvu"></path><path d="M16 18h.01" key="kzsmim"></path></svg>
                    Data
                </button>
                <button (click)="selectCategory('Profissão')"
                    [class.text-blue-600]="selectedCategory === 'Profissão'"
                    class="flex items-center gap-2 text-sm text-gray-700 hover:text-blue-600 focus:text-blue-600">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide"><path d="M12 17v5" key="bb1du9"></path><path d="M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z" key="1nkz8b"></path></svg>
                    Profissão
                </button>
                <button (click)="selectCategory('Pessoa')"
                    [class.text-blue-600]="selectedCategory === 'Pessoa'"
                    class="flex items-center gap-2 text-sm text-gray-700 hover:text-blue-600 focus:text-blue-600">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" key="1yyitq"></path><circle cx="9" cy="7" r="4" key="nufk8"></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87" key="kshegd"></path><path d="M16 3.13a4 4 0 0 1 0 7.75" key="1da9ce"></path></svg>
                    Pessoa
                </button>
                <button (click)="selectCategory('Lugar')"
                    [class.text-blue-600]="selectedCategory === 'Lugar'"
                    class="flex items-center gap-2 text-sm text-gray-700 hover:text-blue-600 focus:text-blue-600">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide"><line x1="2" x2="5" y1="12" y2="12" key="bvdh0s"></line><line x1="19" x2="22" y1="12" y2="12" key="1tbv5k"></line><line x1="12" x2="12" y1="2" y2="5" key="11lu5j"></line><line x1="12" x2="12" y1="19" y2="22" key="x3vr5v"></line><circle cx="12" cy="12" r="7" key="fim9np"></circle><circle cx="12" cy="12" r="3" key="1v7zrd"></circle></svg>
                    Lugar
                </button>
                <button (click)="selectCategory('Organização')"
                    [class.text-blue-600]="selectedCategory === 'Organização'"
                    class="flex items-center gap-2 text-sm text-gray-700 hover:text-blue-600 focus:text-blue-600">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14.0001 3.33333H6.00008C5.2637 3.33333 4.66675 3.93028 4.66675 4.66666V15.3333C4.66675 16.0697 5.2637 16.6667 6.00008 16.6667H14.0001C14.7365 16.6667 15.3334 16.0697 15.3334 15.3333V4.66666C15.3334 3.93028 14.7365 3.33333 14.0001 3.33333Z" stroke="#1F2937" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M8 16.6667V14H12V16.6667" stroke="#1F2937" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M7.33325 6H7.33992" stroke="#1F2937" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12.6667 6H12.6734" stroke="#1F2937" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M10 6H10.0067" stroke="#1F2937" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M10 8.66667H10.0067" stroke="#1F2937" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M10 11.3333H10.0067" stroke="#1F2937" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12.6667 8.66667H12.6734" stroke="#1F2937" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12.6667 11.3333H12.6734" stroke="#1F2937" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M7.33325 8.66667H7.33992" stroke="#1F2937" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M7.33325 11.3333H7.33992" stroke="#1F2937" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Organização
                </button>
            </nav>

            <div class="flex-1 p-4 space-y-4">
                <div *ngFor="let category of Object.keys(filteredEntidades)" [id]="category">
                    <span class="text-[12px] font-semibold text-gray-500">{{ category }}</span>
                    <div class="flex flex-wrap gap-2 mt-1">
                        <span *ngFor="let item of filteredEntidades[category]"
                            (click)="toggleTag(category, item)"
                            [ngClass]="{'bg-gray-200 text-gray-900 border-gray-300': isSelected(category, item), 'bg-gray-100 text-gray-700 border-gray-200': !isSelected(category, item)}"
                            class="text-[12px] px-3 py-1 rounded-md shadow-sm border cursor-pointer hover:bg-gray-200">
                            {{ item }}
                        </span>
                    </div>
                    <hr class="my-4 border-t border-gray-200">
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal Mobile -->
<div *ngIf="isMobile" class="fixed inset-x-0 bottom-0 bg-white rounded-t-xl shadow-lg z-50 p-4 max-h-[80vh] overflow-y-auto">
  
  <div class="w-10 h-1 bg-gray-400 mx-auto rounded-full mb-2"(click)="closeMobileModal()"></div>

  <div class="flex items-center gap-3 border-b pb-2">
    <svg class="w-5 h-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="11" cy="11" r="8"></circle>
      <path d="m21 21-4.3-4.3"></path>
    </svg>
    <input type="text" class="flex-1 border-none outline-none text-gray-700 text-sm placeholder-gray-400" placeholder="Buscar entidade">
  </div>

  <div class="flex space-x-3 mt-3 overflow-x-auto pb-2">
    <button class="px-3 py-1 text-sm text-gray-500 border-b-2 border-transparent hover:border-blue-600">Data</button>
    <button class="px-3 py-1 text-sm text-gray-500 border-b-2 border-transparent hover:border-blue-600">Profissão</button>
    <button class="px-3 py-1 text-sm text-gray-500 border-b-2 border-transparent hover:border-blue-600">Pessoa</button>
    <button class="px-3 py-1 text-sm text-gray-500 border-b-2 border-transparent hover:border-blue-600">Lugar</button>
    <button class="px-3 py-1 text-sm text-gray-500 border-b-2 border-transparent hover:border-blue-600">Organização</button>
  </div>

  <div class="mt-4">
    <div *ngFor="let category of entidades | keyvalue">
      <span class="text-sm font-semibold text-gray-500">{{ category.key }}</span>
      <div class="flex flex-wrap gap-2 mt-1">
        <span *ngFor="let item of category.value" class="bg-gray-200 text-gray-700 px-3 py-1 rounded-full text-sm">
          {{ item }}
        </span>
      </div>
      <hr class="mt-2">
    </div>
  </div>
</div>
